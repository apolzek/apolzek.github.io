{
    "version": "https://jsonfeed.org/version/1",
    "title": "apolzek",
    "home_page_url": "/",
    "feed_url": "/feed.json",
    "description": "blog",
    "icon": "/apple-touch-icon.png",
    "favicon": "/favicon.ico",
    "expired": false,
    
"items": [
    
        {
            "id": "/2025/09/12/sistemas-observaveis-parte-1.html",
            "title": "Sistemas Observáveis - Parte 1",
            "summary": "Reflexão sobre Observabilidade em Ecossistemas Complexos",
            "content_text": "Antes de iniciar, responda as seguintes questões mentalmente:1) É necessário ter monitoramento previamente para alcançar a observabilidade?2) Os dados relacionados ao negócio também fazem parte da observabilidade?3) Quais questões podem ser respondidas ao se atingir o estágio de observabilidade em um sistema?Quando falamos de “observabilidade”, é comum logo pensarmos em uma série de ferramentas e dashboards atraentes. Associamos também esse conceito aos seus pilares, que são: logs, traces e métricas. Mas o que isso realmente significa? Na minha concepção, observabilidade é a capacidade de compreender o funcionamento de um sistema em um determinado momento, sem a necessidade de grandes esforços mentais. Isso requer uma visão abrangente e profunda não apenas dos componentes principais, mas também de suas dependências. Nos últimos anos, temos visto um crescimento exponencial em tamanho e complexidade dos sistemas, o que tem impulsionado a indústria a desenvolver ferramentas avançadas para esse contexto. O que você lerá a seguir é a opinião de alguém que já enfrentou os desafios de suportar produtos críticos operando 24/7, utilizando as mais diversas soluções de observabilidade.Inicialmente tenha em mente que o conceito de observabilidade vai além de ter boas métricas e ferramentas configuradas. Envolve ajudar o observador a entender o que o sistema deveria fazer e se ele de fato está fazendo. Por ser complexo, pode ser abordado de diferentes formas dentro das empresas. O mais comum é trabalhar por níveis, onde o topo da pirâmide se concentra em ver um panorama geral com informações mais ligadas ao negócio. À medida que se desce na pirâmide, tem-se mais dados técnicos e a visão tende a se granularizar. Esse tipo de abordagem ajuda a manter diferentes times focados em analisar aquilo que é de seu domínio técnico (aplicação, rede, banco de dados, etc.). Essa é uma das maneiras de escalar times no ambiente organizacional com varias pessoas envolvidas em várias frentes. Um dos maiores desafios aqui é fornecer uma plataforma uniforme que atenda aos mais variados times de Engenharia.Novamente, se proponha a responder mais um questionamento: Por que alguém decidiu investir tanto para ter visibilidade de um sistema? A primeira resposta que me vem à mente é: porque esse sistema é importante. E aqui não me entenda mal, o sistema pode ser importante tanto por sua capacidade de gerar receita quanto por seu valor ideológico; isso não importa. O que importa é que todos nós estamos empenhados em garantir uma boa experiência para o usuário final. Em determinados momentos, isso pode ser mais valioso do que o próprio dinheiro. Assim, investimos recursos porque sabemos que os erros inevitavelmente ocorrerão e queremos estar preparados de diversas formas para minimizá-los ou corrigi-los rapidamente. Como usuários finais, somos extremamente exigentes.Sistemas computacionais tendem a ser complexos por natureza, pois são construídos sobre uma pilha de abstrações que presumimos estar funcionando corretamente. Se você é um programador, engenheiro de software ou algo do tipo, sabe que existe várias formas de se construir a mesma coisa. Além disso, há as dependências, como sistemas de banco de dados, sistemas de mensageria, caches e outros. Temos também a parte de comunicação, que pode envolver redes de computadores usando diferentes protocolos(pilhas). Nosso objetivo então é ter detalhes sobre todas as partes. Isso permite que saiamos do campo da especulação e entremos no do determinismo. Aqui, o futuro é considerado fixo e definido com base no estado atual e nas leis naturais que governam o universo. Na prática significa que se o throughput de uma API está aumentando, mais chamadas laterais podem acontecer, resultando em um alto consumo de banda e maior uso do banco de dados. Nesse sentido, é importante lembrar que se o sistema foi mal desenhado ou se seus subsistemas carregam débitos técnicos a observabilidade vai te ajudar a identificar esses problemas rapidamente.⚠️ Quem avisa amigo é. Cuidado para não tratar apenas um problema que é reflexo de um problema maior. O efeito cascata é comum em arquiteturas complexas e encontrar a causa raiz costuma  ser difícil! Vamos seguido..Normalmente o que consguimos ter dos sistemas são logs, traces, métricas e eventos. Existem várias ferramentas no mercado para lidar com isso tais como: Prometheus, Grafana, Elasticsearch, Logstash, Kibana, Splunk, New Relic, Datadog, Jaeger, Zipkin, Dynatrace, Honeycomb, AppDynamics, Sentry, Fluentd, Nagios, Zabbix, VictoriaMetrics, Thanos, OpenTelemetry e Graylog. Essa lista é apenas uma pequena amostra, pois há muitas outras ferramentas disponíveis. Quero destacar três das ferramentas supracitadas e fazer uma breve tangente: Dynatrace, New Relic e Datadog. Em todos os lugares em que trabalhei, pelo menos uma dessas três empresas estava presente. O mais intrigante é que todas elas enfrentaram o mesmo problema: custo em ascensão acelerado(custo por mês). Contudo, meu objetivo aqui não é critica-las nem mesmo suas soluções de mercado, mas, em aprender com os seus modelos de negócios e no que eles implicam.Essas empresas normalmente enfrentam três desafios principais. O primeiro está relacionado à própria observabilidade, ou seja, como extrair dados relevantes de sistemas complexos da forma mais abstrata possível para seus clientes. O segundo é como fornecer visualizações rápidas, elegantes e confiáveis, lembrando que cada cliente terá necessidades específicas. O terceiro desafio está relacionado ao modelo de negócio mencionado anteriormente e diz respeito a como essas empresas lidam com a grande quantidade de dados extraídos. A verdade é que crescer é um processo natural e, se você não tiver um bom planejamento, vai precisar de uma boa quantia de dinheiro. Seja porque sua volumetria aumentou, novos sistemas surgiram ou sua configuração de verbosidade não está das melhores. No final, esteja preparado para pagar o preço. Dentre as perguntas que você se propôs a responder até agora, aqui entra a primeira diretamente relacionada a uma grande decisão de um projeto de observabilidade: pagar mais caro e delegar ou tentar economizar abraçando a complexidade técnica? Eu não posso responder essa pergunta e você sabe muito bem disso.Saindo do assunto dinheiro, um movimento que tenho percebido nos últimos anos é a atenção à observabilidade logo no início dos projetos, assim como aconteceu com segurança após décadas de perdas financeiras e vazamentos de dados. As pessoas sabem que precisam ter visibilidade de seus sistemas no dia um(bem como eles precisam estar seguros) e hoje grandes projetos de software (open source ou não) normalmente possuem bons logs e boas métricas(/metrics).A pessoa responsável por buscar observabilidade geralmente começa pesquisando as opções disponíveis para a stack utilizada no projeto ou na empresa. Inicialmente, encontra soluções robustas, porém pagas. Em seguida, inevitavelmente descobre soluções maduras de mercado, como Prometheus, Grafana e OpenTelemetry. Normalmente, a escolha é feita rapidamente, mas existem muitas questões importantes que também devem ser respondidas. Se essas questões forem ignoradas, é apenas uma questão de tempo até que surjam problemas.Definir padrões, fazer previsões de armazenamento, selecionar e manter ferramentas, estabelecer métricas relevantes, configurar rastreamento distribuído, compreender as dependências do sistema, lidar com sistemas assíncronos e diferentes tecnologias são apenas a ponta do iceberg dos desafios que estão por vir.Vamos refletir. Talvez a parte core do seu sistema esteja funcionando normalmente, mas o serviço de autenticação esteja fora do ar. Seus usuários não conseguem fazer login. Isso é suficiente para colocar seu SLA em risco a cada minuto de indisponibilidade. Nesse caso, você deve esperar que algum alarme seja disparado. Caso contrário, dependerá da boa vontade de um engenheiro de confiabilidade abrir o dashboard ou, pior ainda, de uma onda de reclamações no seu canal de atendimento.O cenário hipotético acima ressalta a importância fundamental de um engenheiro competente. As mentes hábeis selecionarão as ferramentas adequadas, que se assemelham a uma terra fértil para o plantio. Estas auxiliarão na geração, captura e armazenamento de dados sobre os sistemas. Posteriormente, o mesmo engenheiro hábil os correlacionará de modo a representarem aspectos significativos do negócio. A agregação desses dados, apresentada de forma simplificada, proporciona uma visão compreensível mesmo para aqueles que não compartilham da mesma visão holística. Em síntese, alguém pensará de antemão para que os subsequentes não precisem fazê-lo. Trata-se de um projeto de melhoria contínua que jamais se encerra. O reflexo disso é ter dados bons o suficiente para montar alarmes eficazes que vão ajudar a responder a incidentes de maneira rápida. Repita esse fluxo várias vezes, pois observabilidade está mais para um processo contínuo do que um estado final.",
            "content_html": "<p>Antes de iniciar, responda as seguintes questões mentalmente:</p><p><strong>1) É necessário ter monitoramento previamente para alcançar a observabilidade?</strong></p><p><strong>2) Os dados relacionados ao negócio também fazem parte da observabilidade?</strong></p><p><strong>3) Quais questões podem ser respondidas ao se atingir o estágio de observabilidade em um sistema?</strong></p><p>Quando falamos de “observabilidade”, é comum logo pensarmos em uma série de ferramentas e dashboards atraentes. Associamos também esse conceito aos seus pilares, que são: logs, traces e métricas. Mas o que isso realmente significa? Na minha concepção, observabilidade é a capacidade de compreender o funcionamento de um sistema em um determinado momento, sem a necessidade de grandes esforços mentais. Isso requer uma visão abrangente e profunda não apenas dos componentes principais, mas também de suas dependências. Nos últimos anos, temos visto um crescimento exponencial em tamanho e complexidade dos sistemas, o que tem impulsionado a indústria a desenvolver ferramentas avançadas para esse contexto. O que você lerá a seguir é a opinião de alguém que já enfrentou os desafios de suportar produtos críticos operando 24/7, utilizando as mais diversas soluções de observabilidade.</p><p>Inicialmente tenha em mente que o conceito de observabilidade vai além de ter boas métricas e ferramentas configuradas. Envolve ajudar o observador a entender o que o sistema deveria fazer e se ele de fato está fazendo. Por ser complexo, pode ser abordado de diferentes formas dentro das empresas. O mais comum é trabalhar por níveis, onde o topo da pirâmide se concentra em ver um panorama geral com informações mais ligadas ao negócio. À medida que se desce na pirâmide, tem-se mais dados técnicos e a visão tende a se granularizar. Esse tipo de abordagem ajuda a manter diferentes times focados em analisar aquilo que é de seu domínio técnico (aplicação, rede, banco de dados, etc.). Essa é uma das maneiras de escalar times no ambiente organizacional com varias pessoas envolvidas em várias frentes. Um dos maiores desafios aqui é fornecer uma plataforma uniforme que atenda aos mais variados times de Engenharia.</p><p>Novamente, se proponha a responder mais um questionamento: <strong>Por que alguém decidiu investir tanto para ter visibilidade de um sistema?</strong> A primeira resposta que me vem à mente é: porque esse sistema é importante. E aqui não me entenda mal, o sistema pode ser importante tanto por sua capacidade de gerar receita quanto por seu valor ideológico; isso não importa. O que importa é que todos nós estamos empenhados em garantir uma boa experiência para o usuário final. Em determinados momentos, isso pode ser mais valioso do que o próprio dinheiro. Assim, investimos recursos porque sabemos que os erros inevitavelmente ocorrerão e queremos estar preparados de diversas formas para minimizá-los ou corrigi-los rapidamente. Como usuários finais, somos extremamente exigentes.</p><p>Sistemas computacionais tendem a ser complexos por natureza, pois são construídos sobre uma pilha de abstrações que presumimos estar funcionando corretamente. Se você é um programador, engenheiro de software ou algo do tipo, sabe que existe várias formas de se construir a mesma coisa. Além disso, há as dependências, como sistemas de banco de dados, sistemas de mensageria, caches e outros. Temos também a parte de comunicação, que pode envolver redes de computadores usando diferentes protocolos(pilhas). Nosso objetivo então é ter detalhes sobre todas as partes. Isso permite que saiamos do campo da especulação e entremos no do determinismo. Aqui, o futuro é considerado fixo e definido com base no estado atual e nas leis naturais que governam o universo. Na prática significa que se o throughput de uma API está aumentando, mais chamadas laterais podem acontecer, resultando em um alto consumo de banda e maior uso do banco de dados. Nesse sentido, é importante lembrar que se o sistema foi mal desenhado ou se seus subsistemas carregam débitos técnicos a observabilidade vai te ajudar a identificar esses problemas rapidamente.</p><p>⚠️ Quem avisa amigo é. Cuidado para não tratar apenas um problema que é reflexo de um problema maior. O efeito cascata é comum em arquiteturas complexas e encontrar a causa raiz costuma  ser difícil! Vamos seguido..</p><p>Normalmente o que consguimos ter dos sistemas são logs, traces, métricas e eventos. Existem várias ferramentas no mercado para lidar com isso tais como: Prometheus, Grafana, Elasticsearch, Logstash, Kibana, Splunk, New Relic, Datadog, Jaeger, Zipkin, Dynatrace, Honeycomb, AppDynamics, Sentry, Fluentd, Nagios, Zabbix, VictoriaMetrics, Thanos, OpenTelemetry e Graylog. Essa lista é apenas uma pequena amostra, pois há muitas outras ferramentas disponíveis. Quero destacar três das ferramentas supracitadas e fazer uma breve tangente: <strong>Dynatrace, New Relic e Datadog</strong>. Em todos os lugares em que trabalhei, pelo menos uma dessas três empresas estava presente. O mais intrigante é que todas elas enfrentaram o mesmo problema: <strong>custo em ascensão acelerado(custo por mês)</strong>. Contudo, meu objetivo aqui não é critica-las nem mesmo suas soluções de mercado, mas, em aprender com os seus modelos de negócios e no que eles implicam.</p><p>Essas empresas normalmente enfrentam três desafios principais. O primeiro está relacionado à própria observabilidade, ou seja, como extrair dados relevantes de sistemas complexos da forma mais abstrata possível para seus clientes. O segundo é como fornecer visualizações rápidas, elegantes e confiáveis, lembrando que cada cliente terá necessidades específicas. O terceiro desafio está relacionado ao modelo de negócio mencionado anteriormente e diz respeito a como essas empresas lidam com a <strong>grande quantidade de dados</strong> extraídos. A verdade é que crescer é um processo natural e, se você não tiver um bom planejamento, vai precisar de uma boa quantia de dinheiro. Seja porque sua volumetria aumentou, novos sistemas surgiram ou sua configuração de verbosidade não está das melhores. No final, esteja preparado para pagar o preço. Dentre as perguntas que você se propôs a responder até agora, aqui entra a primeira diretamente relacionada a uma grande decisão de um projeto de observabilidade: <strong>pagar mais caro e delegar ou tentar economizar abraçando a complexidade técnica?</strong> Eu não posso responder essa pergunta e você sabe muito bem disso.</p><p>Saindo do assunto dinheiro, um movimento que tenho percebido nos últimos anos é a atenção à observabilidade logo no início dos projetos, assim como aconteceu com segurança após décadas de perdas financeiras e vazamentos de dados. As pessoas sabem que precisam ter visibilidade de seus sistemas no dia um(bem como eles precisam estar seguros) e hoje grandes projetos de software (open source ou não) normalmente possuem bons logs e boas métricas(<em>/metrics</em>).</p><p>A pessoa responsável por buscar observabilidade geralmente começa pesquisando as opções disponíveis para a stack utilizada no projeto ou na empresa. Inicialmente, encontra soluções robustas, porém pagas. Em seguida, inevitavelmente descobre soluções maduras de mercado, como Prometheus, Grafana e OpenTelemetry. Normalmente, a escolha é feita rapidamente, mas existem muitas questões importantes que também devem ser respondidas. Se essas questões forem ignoradas, é apenas uma questão de tempo até que surjam problemas.</p><p>Definir padrões, fazer previsões de armazenamento, selecionar e manter ferramentas, estabelecer métricas relevantes, configurar rastreamento distribuído, compreender as dependências do sistema, lidar com sistemas assíncronos e diferentes tecnologias são apenas a ponta do iceberg dos desafios que estão por vir.</p><p>Vamos refletir. Talvez a parte <strong>core</strong> do seu sistema esteja funcionando normalmente, mas o serviço de autenticação esteja fora do ar. Seus usuários não conseguem fazer login. Isso é suficiente para colocar seu SLA em risco a cada minuto de indisponibilidade. Nesse caso, você deve esperar que algum alarme seja disparado. Caso contrário, dependerá da boa vontade de um engenheiro de confiabilidade abrir o dashboard ou, pior ainda, de uma onda de reclamações no seu canal de atendimento.</p><p>O cenário hipotético acima ressalta a importância fundamental de um engenheiro competente. As mentes hábeis selecionarão as ferramentas adequadas, que se assemelham a uma terra fértil para o plantio. Estas auxiliarão na geração, captura e armazenamento de dados sobre os sistemas. Posteriormente, o mesmo engenheiro hábil os correlacionará de modo a representarem aspectos significativos do negócio. A agregação desses dados, apresentada de forma simplificada, proporciona uma visão compreensível mesmo para aqueles que não compartilham da mesma visão holística. Em síntese, alguém pensará de antemão para que os subsequentes não precisem fazê-lo. Trata-se de um projeto de melhoria contínua que jamais se encerra. O reflexo disso é ter dados bons o suficiente para montar alarmes eficazes que vão ajudar a responder a incidentes de maneira rápida. Repita esse fluxo várias vezes, pois observabilidade está mais para um processo contínuo do que um estado final.</p>",
            "url": "/2025/09/12/sistemas-observaveis-parte-1.html",
            
            
            
            "tags": ["observabilidade","monitoramento"],
            
            "date_published": "2025-09-12T00:00:00+00:00",
            "date_modified": "2025-09-12T00:00:00+00:00",
            
                "author": 
                ""
                
            
        },
    
        {
            "id": "/2024/07/09/por-que-nao-alarmou.html",
            "title": "😭 Por que não alarmou ?",
            "summary": "Uma breve reflexão sobre a criação de alertas que realmente funcionam como deveriam",
            "content_text": "Já aconteceu de você configurar um alarme e ele não funcionar como esperado ? Seu SLA estava sendo comprometido sem que você soubesse ? Isso aconteceu comigo e me trouxe algumas lições importantes que gostaria de compartilhar.Feijão com arrozAntes de pensar em alertas eficazes, é essencial ter um sistema de monitoramento robusto que colete boas métricas em intervalos apropriados, levando em consideração a criticidade do contexto analisado. Mas o que são exatamente “boas métricas”? Em geral, são métricas relevantes, contextualizadas, consistentes, confiáveis e bem categorizadas(labels).Partindo do pressuposto de que você já tem tudo isso, é hora de configurar os alarmes. Você pode usar ferramentas populares para essa tarefa, como o Alertmanager e o Grafana. Elas funcionam de maneira similar e os ingredientes são os mesmos: um nome para o alerta, uma métrica, um limite (threshold), um canal de notificação e informações adicionais, como descrição e nível de criticidade. Embora o processo seja relativamente simples, configurar um alarme pode exigir atenção a detalhes importantes, como ajustar corretamente o threshold em relação aos seus pontos de dados(data points) ou agrupar alarmes correlacionados, já que certos problemas podem desencadear uma cascata de subproblemas, resultando em múltiplos alertas durante um incidente(e um telefone tocando freneticamente).De maneira geral, os alarmes estarão relacionados às principais métricas do objeto ou contexto monitorado. Por exemplo, se você está monitorando um microsserviço, vai querer saber coisas como response time, latency, throughput, resource utilization, além de acompanhar CPU, memory e I/O. Se você está monitorando uma rede, vai querer saber coisas como latency, packet error rate, packet loss rate, network utilization, response time, number of sessions, throughput, inbound and outbound traffic e active connections. Se está monitorando um banco de dados começa a olhar coisas como query performance, response time, throughput, CPU usage, memory usage, disk I/O, connection count, query execution time, deadlocks, index usage, replication lag e transaction rate. Veja bem, CPU, memória e disco são métricas essenciais na maioria dos casos e se você as analisar com atenção, elas podem ajudar a prever possíveis catástrofes.Quantidade x QualidadeO conceito de code coverage (cobertura de código), que mede a extensão em que o código-fonte de um programa é testado, pode ser aplicado à criação de alarmes, resultando no que chamamos de alarm coverage. A ideia é mapear possíveis problemas e classificá-los de acordo com seu impacto. Apesar de isso naturalmente sugerir que você deve ter muitos alarmes em toda a superfície, tenha em mente que, na verdade, você precisa apenas de alarmes nos lugares certos, aqueles que possuem alto impacto no seu SLA. Uma abordagem top-down pode ser útil nesse processo. Lembre-se também de que trabalhar com observabilidade é um processo de melhoria contínua, e não um estado final. Sempre há necessidade de revisão, pois o sistema está em constante mudança e o nível de carga que você recebe tende a variar ao longo do tempo. Resumindo..“Se tratando de alarmes, ser efetivo é ter alarmes suficientes para cobrir pontos críticos do seu sistema com limiares sensatos para cada objeto monitorado”.Média, Moda e MedianaO texto abaixo foi extraído do site todamateria, acessível por esse link. É importante entender esses conceitos para evitar o que se chama de “tiro no pé” ao tratar de alarmes.A média (Me) é calculada somando-se todos os valores de um conjunto de dados e dividindo-se pelo número de elementos deste conjunto. Como a média é uma medida sensível aos valores da amostra, é mais adequada para situações em que os dados são distribuídos mais ou menos de forma uniforme, ou seja, valores sem grandes discrepâncias.A Moda (Mo) representa o valor mais frequente de um conjunto de dados, sendo assim, para defini-la basta observar a frequência com que os valores aparecem. Um conjunto de dados é chamado de bimodal quando apresenta duas modas, ou seja, dois valores são mais frequentes.A Mediana (Md) representa o valor central de um conjunto de dados. Para encontrar o valor da mediana é necessário colocar os valores em ordem crescente ou decrescente. Quando o número elementos de um conjunto é par, a mediana é encontrada pela média dos dois valores centrais. Assim, esses valores são somados e divididos por dois.‘Os conceitos acima foram referenciados para lembrar algumas coisas ao usar essas funções em métricas. A primeira coisa é que normalmente a média não existe (o valor dela não existe). A segunda coisa é que se os números usados para calcular a média podem não ter proximidade, inviabilizando o real status do que se monitora.’P50, P75, 95, P99, PQP(rs)..Em sistemas de monitoramento, a análise de desempenho é fundamental para garantir eficiência e confiabilidade. Percentis, como P50 (percentil 50) e P95 (percentil 95), são ferramentas valiosas nesse contexto, pois oferecem uma visão detalhada do comportamento dos dados e ajudam a identificar problemas de desempenho que podem não ser evidentes com métricas básicas, como a média. A mediana, por ser uma medida estável, é eficaz para identificar tendências de longo prazo. No entanto, ela pode não capturar tendências ou anomalias de curto prazo. motherfuck, o que usar então ? Vamos usar percentis, eles são medidas estatísticas que dividem um conjunto de dados em 100 partes iguais, permitindo analisar a distribuição dos dados em uma escala mais detalhada. Em termos de métricas, percentis são usados para entender a posição relativa de um valor dentro de um conjunto de dados e para identificar como os dados se distribuem em torno de valores específicos.      P50 (percentil 50): Também conhecido como mediana, é o valor que divide o conjunto de dados em duas partes iguais, com 50% dos dados abaixo e 50% acima desse valor. É útil para medir a tendência central.        P75 (percentil 75): É uma medida estatística que representa o valor abaixo do qual 75% dos dados em um conjunto se encontram.Esse percentil é útil para entender melhor a distribuição dos dados e identificar o ponto onde a maioria dos valores se concentra, excluindo os 25% mais altos. Em análise de desempenho, por exemplo, o P75 pode ajudar a identificar a carga de trabalho ou o tempo de resposta típico, excluindo os valores mais extremos que poderiam distorcer a visão geral.        P95 (percentil 95): É o valor abaixo do qual 95% dos dados se encontram. Em outras palavras, 5% dos dados são maiores que o P95. Esse percentil é útil para identificar valores extremos e entender a cauda superior da distribuição.        P99 (percentil 99): É o valor abaixo do qual 99% dos dados se encontram. Isso ajuda a identificar eventos raros ou extremos, que podem ser críticos em análises de desempenho e monitoramento.  Threshold e Tempo de ColetaDois aspectos críticos na configuração de alarmes são o threshold (limite de alarme) e o tempo de coleta. Compreender e ajustar adequadamente esses parâmetros pode fazer a diferença entre um sistema bem monitorado e um que gera muitos falsos positivos ou, pior, não detecta problemas críticos a tempo. O threshold é o valor de referência que, quando atingido ou ultrapassado, aciona um alarme. A escolha do threshold é fundamental, pois define quando o sistema deve alertar os administradores sobre uma possível anomalia ou falha. O tempo de coleta refere-se ao intervalo de tempo usado para coletar e analisar métricas antes de acionar um alarme. Esse intervalo pode variar de segundos a minutos, dependendo da criticidade da métrica e do comportamento do sistema.Monitoramento ProativoDocumentação e ProcedimentosAlertas baseados em logsapp_request_latency_seconds_bucket {__name__=\"app_request_latency_seconds_bucket\", endpoint=\"/\", instance=\"flask-app:5000\", job=\"app_exporter\", le=\"1.0\", method=\"GET\"}1172024-07-09 16:28:08app_request_latency_seconds_bucket {__name__=\"app_request_latency_seconds_bucket\", endpoint=\"/\", instance=\"flask-app:5000\", job=\"app_exporter\", le=\"1.0\", method=\"GET\"}318",
            "content_html": "<p>Já aconteceu de você configurar um alarme e ele não funcionar como esperado ? Seu SLA estava sendo comprometido sem que você soubesse ? Isso aconteceu comigo e me trouxe algumas lições importantes que gostaria de compartilhar.</p><h2 id=\"feijão-com-arroz\">Feijão com arroz</h2><p>Antes de pensar em alertas eficazes, é essencial ter um sistema de monitoramento robusto que colete boas métricas em intervalos apropriados, levando em consideração a criticidade do contexto analisado. Mas o que são exatamente “<strong>boas métricas</strong>”? Em geral, são métricas relevantes, contextualizadas, consistentes, confiáveis e bem categorizadas(labels).</p><p>Partindo do pressuposto de que você já tem tudo isso, é hora de configurar os alarmes. Você pode usar ferramentas populares para essa tarefa, como o Alertmanager e o Grafana. Elas funcionam de maneira similar e os ingredientes são os mesmos: um nome para o alerta, uma métrica, um limite (threshold), um canal de notificação e informações adicionais, como descrição e nível de criticidade. Embora o processo seja relativamente simples, configurar um alarme pode exigir atenção a detalhes importantes, como ajustar corretamente o threshold em relação aos seus pontos de dados(data points) ou agrupar alarmes correlacionados, já que certos problemas podem desencadear uma cascata de subproblemas, resultando em múltiplos alertas durante um incidente(e um telefone tocando freneticamente).</p><p>De maneira geral, os alarmes estarão relacionados às principais métricas do objeto ou contexto monitorado. Por exemplo, se você está monitorando um <strong>microsserviço</strong>, vai querer saber coisas como <em>response time, latency, throughput, resource utilization</em>, além de acompanhar <em>CPU, memory e I/O</em>. Se você está monitorando uma <strong>rede</strong>, vai querer saber coisas como <em>latency, packet error rate, packet loss rate, network utilization, response time, number of sessions, throughput, inbound and outbound traffic e active connections</em>. Se está monitorando um <strong>banco de dados</strong> começa a olhar coisas como <em>query performance, response time, throughput, CPU usage, memory usage, disk I/O, connection count, query execution time, deadlocks, index usage, replication lag e transaction rate</em>. Veja bem, CPU, memória e disco são métricas essenciais na maioria dos casos e se você as analisar com atenção, elas podem ajudar a prever possíveis catástrofes.</p><h2 id=\"quantidade-x-qualidade\">Quantidade x Qualidade</h2><p>O conceito de <em>code coverage</em> (cobertura de código), que mede a extensão em que o código-fonte de um programa é testado, pode ser aplicado à criação de alarmes, resultando no que chamamos de <em>alarm coverage</em>. A ideia é mapear possíveis problemas e classificá-los de acordo com seu impacto. Apesar de isso naturalmente sugerir que você deve ter muitos alarmes em toda a superfície, tenha em mente que, na verdade, você precisa apenas de alarmes nos lugares certos, aqueles que possuem alto impacto no seu SLA. Uma abordagem top-down pode ser útil nesse processo. Lembre-se também de que trabalhar com observabilidade é um processo de melhoria contínua, e não um estado final. Sempre há necessidade de revisão, pois o sistema está em constante mudança e o nível de carga que você recebe tende a variar ao longo do tempo. Resumindo..</p><p>“Se tratando de alarmes, ser efetivo é ter alarmes suficientes para cobrir pontos críticos do seu sistema com limiares sensatos para cada objeto monitorado”.</p><h2 id=\"média-moda-e-mediana\">Média, Moda e Mediana</h2><p>O texto abaixo foi extraído do site <a href=\"https://www.todamateria.com.br/\">todamateria</a>, acessível por <a href=\"https://www.todamateria.com.br/media-moda-e-mediana/\">esse link</a>. É importante entender esses conceitos para evitar o que se chama de “tiro no pé” ao tratar de alarmes.</p><p>A <strong>média</strong> (Me) é calculada somando-se todos os valores de um conjunto de dados e dividindo-se pelo número de elementos deste conjunto. Como a média é uma medida sensível aos valores da amostra, é mais adequada para situações em que os dados são distribuídos mais ou menos de forma uniforme, ou seja, valores sem grandes discrepâncias.</p><p>A <strong>Moda</strong> (Mo) representa o valor mais frequente de um conjunto de dados, sendo assim, para defini-la basta observar a frequência com que os valores aparecem. Um conjunto de dados é chamado de bimodal quando apresenta duas modas, ou seja, dois valores são mais frequentes.</p><p>A <strong>Mediana</strong> (Md) representa o valor central de um conjunto de dados. Para encontrar o valor da mediana é necessário colocar os valores em ordem crescente ou decrescente. Quando o número elementos de um conjunto é par, a mediana é encontrada pela média dos dois valores centrais. Assim, esses valores são somados e divididos por dois.</p><p>‘Os conceitos acima foram referenciados para lembrar algumas coisas ao usar essas funções em métricas. A primeira coisa é que normalmente a média não existe (o valor dela não existe). A segunda coisa é que se os números usados para calcular a média podem não ter proximidade, inviabilizando o real status do que se monitora.’</p><h2 id=\"p50-p75-95-p99-pqprs\">P50, P75, 95, P99, PQP(rs)..</h2><p>Em sistemas de monitoramento, a análise de desempenho é fundamental para garantir eficiência e confiabilidade. Percentis, como P50 (percentil 50) e P95 (percentil 95), são ferramentas valiosas nesse contexto, pois oferecem uma visão detalhada do comportamento dos dados e ajudam a identificar problemas de desempenho que podem não ser evidentes com métricas básicas, como a média. A mediana, por ser uma medida estável, é eficaz para identificar tendências de longo prazo. No entanto, ela pode não capturar tendências ou anomalias de curto prazo. motherfuck, o que usar então ? Vamos usar <strong>percentis</strong>, eles são medidas estatísticas que dividem um conjunto de dados em 100 partes iguais, permitindo analisar a distribuição dos dados em uma escala mais detalhada. Em termos de métricas, percentis são usados para entender a posição relativa de um valor dentro de um conjunto de dados e para identificar como os dados se distribuem em torno de valores específicos.</p><ul>  <li>    <p>P50 (percentil 50): Também conhecido como mediana, é o valor que divide o conjunto de dados em duas partes iguais, com 50% dos dados abaixo e 50% acima desse valor. É útil para medir a tendência central.</p>  </li>  <li>    <p>P75 (percentil 75): É uma medida estatística que representa o valor abaixo do qual 75% dos dados em um conjunto se encontram.Esse percentil é útil para entender melhor a distribuição dos dados e identificar o ponto onde a maioria dos valores se concentra, excluindo os 25% mais altos. Em análise de desempenho, por exemplo, o P75 pode ajudar a identificar a carga de trabalho ou o tempo de resposta típico, excluindo os valores mais extremos que poderiam distorcer a visão geral.</p>  </li>  <li>    <p>P95 (percentil 95): É o valor abaixo do qual 95% dos dados se encontram. Em outras palavras, 5% dos dados são maiores que o P95. Esse percentil é útil para identificar valores extremos e entender a cauda superior da distribuição.</p>  </li>  <li>    <p>P99 (percentil 99): É o valor abaixo do qual 99% dos dados se encontram. Isso ajuda a identificar eventos raros ou extremos, que podem ser críticos em análises de desempenho e monitoramento.</p>  </li></ul><h2 id=\"threshold-e-tempo-de-coleta\">Threshold e Tempo de Coleta</h2><p>Dois aspectos críticos na configuração de alarmes são o threshold (limite de alarme) e o tempo de coleta. Compreender e ajustar adequadamente esses parâmetros pode fazer a diferença entre um sistema bem monitorado e um que gera muitos falsos positivos ou, pior, não detecta problemas críticos a tempo. O threshold é o valor de referência que, quando atingido ou ultrapassado, aciona um alarme. A escolha do threshold é fundamental, pois define quando o sistema deve alertar os administradores sobre uma possível anomalia ou falha. O tempo de coleta refere-se ao intervalo de tempo usado para coletar e analisar métricas antes de acionar um alarme. Esse intervalo pode variar de segundos a minutos, dependendo da criticidade da métrica e do comportamento do sistema.</p><h2 id=\"monitoramento-proativo\">Monitoramento Proativo</h2><h2 id=\"documentação-e-procedimentos\">Documentação e Procedimentos</h2><h2 id=\"alertas-baseados-em-logs\">Alertas baseados em logs</h2><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>app_request_latency_seconds_bucket {__name__=\"app_request_latency_seconds_bucket\", endpoint=\"/\", instance=\"flask-app:5000\", job=\"app_exporter\", le=\"1.0\", method=\"GET\"}117</code></pre></div></div><p>2024-07-09 16:28:08</p><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>app_request_latency_seconds_bucket {__name__=\"app_request_latency_seconds_bucket\", endpoint=\"/\", instance=\"flask-app:5000\", job=\"app_exporter\", le=\"1.0\", method=\"GET\"}318</code></pre></div></div>",
            "url": "/2024/07/09/por-que-nao-alarmou.html",
            
            
            
            "tags": ["prometheus","alerts"],
            
            "date_published": "2024-07-09T00:00:00+00:00",
            "date_modified": "2024-07-09T00:00:00+00:00",
            
                "author": 
                ""
                
            
        },
    
        {
            "id": "/2024/07/01/sre-tips-and-tricks.html",
            "title": "SRE Tips and Tricks",
            "summary": "Tips And Tricks",
            "content_text": "1 - Use um Gerenciador de versões (Multiple Runtime Version Manager)É natural precisarmos de mais de uma versão de uma ferramenta ou de uma linguagem de programação. Use um gerenciador de versões para fazer isso. Essa é pra você que, num dia, está rodando um projeto em Java 11 e, no outro, precisa de Java 22. Ou para aquele SRE que precisa alternar entre versões de Terraform e fica usando tfenv. Isso pode te ajudar nos estudos, no trabalho e também a deixar de lado aquela preguiça de ter que instalar coisas para testar um projeto ou ferramenta aleatória do GitHub. Desse jeito, fica easy e, se você faz tudo certinho, não quebra seu Linux #confia. Abaixo estão boas alternativas com alguns exemplos de como fazer isso:asdfasdf: https://asdf-vm.com/asdf --versionasdf plugin add javaasdf install java graalvm-22.3.0+java19asdf global java graalvm-22.3.0+java19tail $HOME/.tool-versionsjava --versionmisemise: https://mise.jdx.dev/mise use -g ruby@3.22 - AliasEssa dica pode te fazer economizar um bom tempo. Alias são apelidos para outros comandos, que normalmente são grandes e/ou complexos.alias ls='ls --color=auto'alias grep='grep --color=auto'alias docker_killall='docker rm -f $(docker ps -aq)'alias MONITOR_ALL='xrandr --output HDMI-1 --mode 1920x1080 --primary --left-of eDP-1 --output eDP-1 --auto'alias MONITOR_JUST_HDMI='xrandr --output HDMI-1 --mode 1920x1080 --primary --output eDP-1 --off'alias MONITOR_JUST_NOTEBOOK='xrandr --output HDMI-1 --off --output eDP-1 --auto'alias MONITOR_NOTEBOOK_BRILHANTE='xrandr --output eDP-1 --brightness 1.2'alias KEYBOARD_LOCAL='setxkbmap -model thinkpad -layout br -variant abnt2'alias clip='xclip -selection clipboard'alias WIFIPASS='echo \\# cat /etc/NetworkManager/system-connections/*'3 - Use docker, kind, docker compose, local stack SEM MEDOOO de ser felizCrie ambientes isolados pra realizar seus testes usando containers. Seja com docker ou podman, crie manifestos completos montando ambientes que você precisa. Dessa forma você protege seu ambiente local, além disso consegue setar diferentes versões, consegue testar aquivos de configuração e também limitar utilização de recursos computacionais.4 - Saiba fazer a mesma coisa de diferentes formasYeeep, normalmente existem várias maneiras de se fazer a mesma coisa. Para uns ter um PADRÃO é tudo e eu concordo, mas não é nesse sentido que essa dica quer dizer. Eu estou falando de conseguir dansar qualquer ritmo de dança. Suponha que você precisa criar um servidor http local e você só sabe fazer usando python.. então você acaba dependendo do python. Tenha em mente que normalmente dá pra fazer de forma diferente e sabendo disso você consegue atuar em situações adversas.mise use -g ruby@3.2gem install webrickruby -run -ehttpd . -p8000Tip 6: Redes de Computadores, tente aprender isso em profundidade, não apenas superficialmente",
            "content_html": "<h2 id=\"1---use-um-gerenciador-de-versões-multiple-runtime-version-manager\">1 - Use um Gerenciador de versões (Multiple Runtime Version Manager)</h2><p>É natural precisarmos de mais de uma versão de uma ferramenta ou de uma linguagem de programação. Use um gerenciador de versões para fazer isso. Essa é pra você que, num dia, está rodando um projeto em Java 11 e, no outro, precisa de Java 22. Ou para aquele SRE que precisa alternar entre versões de Terraform e fica usando tfenv. Isso pode te ajudar nos estudos, no trabalho e também a deixar de lado aquela preguiça de ter que instalar coisas para testar um projeto ou ferramenta aleatória do GitHub. Desse jeito, fica easy e, se você faz tudo certinho, não quebra seu Linux <em>#confia</em>. Abaixo estão boas alternativas com alguns exemplos de como fazer isso:</p><h4 id=\"asdf\">asdf</h4><p><strong>asdf</strong>: https://asdf-vm.com/</p><div class=\"language-sh highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>asdf <span class=\"nt\">--version</span>asdf plugin add javaasdf <span class=\"nb\">install </span>java graalvm-22.3.0+java19asdf global java graalvm-22.3.0+java19<span class=\"nb\">tail</span> <span class=\"nv\">$HOME</span>/.tool-versionsjava <span class=\"nt\">--version</span></code></pre></div></div><h4 id=\"mise\">mise</h4><p><strong>mise</strong>: https://mise.jdx.dev/</p><div class=\"language-sh highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>mise use <span class=\"nt\">-g</span> ruby@3.2</code></pre></div></div><h2 id=\"2---alias\">2 - Alias</h2><p>Essa dica pode te fazer economizar um bom tempo. Alias são apelidos para outros comandos, que normalmente são grandes e/ou complexos.</p><div class=\"language-sh highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">alias ls</span><span class=\"o\">=</span><span class=\"s1\">'ls --color=auto'</span><span class=\"nb\">alias grep</span><span class=\"o\">=</span><span class=\"s1\">'grep --color=auto'</span><span class=\"nb\">alias </span><span class=\"nv\">docker_killall</span><span class=\"o\">=</span><span class=\"s1\">'docker rm -f $(docker ps -aq)'</span><span class=\"nb\">alias </span><span class=\"nv\">MONITOR_ALL</span><span class=\"o\">=</span><span class=\"s1\">'xrandr --output HDMI-1 --mode 1920x1080 --primary --left-of eDP-1 --output eDP-1 --auto'</span><span class=\"nb\">alias </span><span class=\"nv\">MONITOR_JUST_HDMI</span><span class=\"o\">=</span><span class=\"s1\">'xrandr --output HDMI-1 --mode 1920x1080 --primary --output eDP-1 --off'</span><span class=\"nb\">alias </span><span class=\"nv\">MONITOR_JUST_NOTEBOOK</span><span class=\"o\">=</span><span class=\"s1\">'xrandr --output HDMI-1 --off --output eDP-1 --auto'</span><span class=\"nb\">alias </span><span class=\"nv\">MONITOR_NOTEBOOK_BRILHANTE</span><span class=\"o\">=</span><span class=\"s1\">'xrandr --output eDP-1 --brightness 1.2'</span><span class=\"nb\">alias </span><span class=\"nv\">KEYBOARD_LOCAL</span><span class=\"o\">=</span><span class=\"s1\">'setxkbmap -model thinkpad -layout br -variant abnt2'</span><span class=\"nb\">alias </span><span class=\"nv\">clip</span><span class=\"o\">=</span><span class=\"s1\">'xclip -selection clipboard'</span><span class=\"nb\">alias </span><span class=\"nv\">WIFIPASS</span><span class=\"o\">=</span><span class=\"s1\">'echo \\# cat /etc/NetworkManager/system-connections/*'</span></code></pre></div></div><h2 id=\"3---use-docker-kind-docker-compose-local-stack-sem-medooo-de-ser-feliz\">3 - Use docker, kind, docker compose, local stack SEM MEDOOO de ser feliz</h2><p>Crie ambientes isolados pra realizar seus testes usando containers. Seja com docker ou podman, crie manifestos completos montando ambientes que você precisa. Dessa forma você protege seu ambiente local, além disso consegue setar diferentes versões, consegue testar aquivos de configuração e também limitar utilização de recursos computacionais.</p><h2 id=\"4---saiba-fazer-a-mesma-coisa-de-diferentes-formas\">4 - Saiba fazer a mesma coisa de diferentes formas</h2><p>Yeeep, normalmente existem várias maneiras de se fazer a mesma coisa. Para uns ter um PADRÃO é tudo e eu concordo, mas não é nesse sentido que essa dica quer dizer. Eu estou falando de conseguir dansar qualquer ritmo de dança. Suponha que você precisa criar um servidor http local e você só sabe fazer usando python.. então você acaba dependendo do python. Tenha em mente que normalmente dá pra fazer de forma diferente e sabendo disso você consegue atuar em situações adversas.</p><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>mise use -g ruby@3.2gem install webrickruby -run -ehttpd . -p8000</code></pre></div></div><h2 id=\"tip-6-redes-de-computadores-tente-aprender-isso-em-profundidade-não-apenas-superficialmente\">Tip 6: Redes de Computadores, tente aprender isso em profundidade, não apenas superficialmente</h2>",
            "url": "/2024/07/01/sre-tips-and-tricks.html",
            
            
            
            "tags": ["tips","linux","sre"],
            
            "date_published": "2024-07-01T00:00:00+00:00",
            "date_modified": "2024-07-01T00:00:00+00:00",
            
                "author": 
                ""
                
            
        }
    
    ]
}